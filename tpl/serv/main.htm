
<div id="all_resp">{resp}</div>

<div class="row" id="server-stats" style="padding-top: 0px;">

    <div class="col-xl-4 col-md-0 mb-0">
        <div class="small-box bg-danger rounded-0">
            <div class="overlay dark">
                <i class="fas fa-3x fa-sync-alt"></i>
            </div>
            <div class="inner">
                <h3>Offline</h3>

                <p>Server Status</p>
            </div>
            <div class="icon">
                <i class="fa fa-server"></i>
            </div>
            <a href="#" class="small-box-footer">&nbsp;</a>
        </div>
    </div>

    <div class="col-xl-4 col-md-0 mb-0">
        <div class="info-box bg-info rounded-0" style="height: 142px;">
            <div class="overlay dark">
                <i class="fas fa-3x fa-sync-alt"></i>
            </div>
            <span class="info-box-icon"><i class="fa fa-users"></i></span>

            <div class="info-box-content">
                <span class="info-box-text">Spieler</span>
                <span class="info-box-number">0 / 70</span>

                <div class="progress">
                    <div class="progress-bar" style="width: 0%"></div>
                </div>
                <span class="progress-description">
                    <br />
                      <button type="button" class="btn btn-block btn-dark btn-sm">Spieler Zeigen</button>
                    </span>
            </div>
        </div>
    </div>

    <div class="col-xl-4 col-md-0 mb-0">
        <div class="small-box bg-danger">
            <div class="overlay dark rounded-0">
                <i class="fas fa-3x fa-sync-alt"></i>
            </div>
            <div class="inner">
                <h3 class="text-white">Gesperrt</h3>
                <p class="text-white">Aktion Status</p>
            </div>
            <div class="icon">
                <i class="fa fa-tasks"></i>
            </div>
            <a href="#" class="small-box-footer">Aktionen sind Gesperrt</a>
        </div>
    </div>
</div>

<div class="row">

    <style>
        .server_head {
            max-height:240px;
        }
        .server_head > span {
            position: absolute;
            bottom: 0;
            left: 0;
            padding: 15px;
            color: #f8f9fa;
            font-size: 1.2rem;
        }
    </style>


    <div class="list-group col-xl-3 col-md-4 mb-4" style="padding-left: .75rem;">
        <div class="card card-widget widget-user">
            <div class="widget-user-header text-white" style="background: url('/dist/img/backgrounds/bg.jpg') center center;">
                <h3 class="widget-user-username text-center text-gray-dark left">{servername}</h3>
                <h5 class="widget-user-desc text-center text-gray-dark">{global_IP}:{QPort}</h5>
            </div>
            <div class="widget-user-image" id="serv_img" style="z-index: 1000">
                <img src="/dist/img/logo/ark.png" style="border-radius: 25rem!important;height: 90px;width: 90px;background-color: #001f3f" class="border-danger">
            </div>
            <div class="card card-widget widget-user mb-0">
                <div class="text-left left d-inline" style="width:50%">
                    <button data-toggle="tooltip" data-placement="top" title="" data-original-title="IP Kopieren" aria-hidden="true" style="width: 100%" class="btn btn-dark" onclick="copyToClipboard('info')" id="btnCopy"><i class="fas fa-copy"></i></button>
                </div>
                <div class="right-no-top ml-auto d-inline" style="width:50%">
                    <a data-toggle="tooltip" data-placement="top" title="" data-original-title="Direkt Joinen" aria-hidden="true" style="width: 100%" {ifonline}href="{joinurl}"{/ifonline} class="text-white btn btn-dark {!ifonline}disabled{/!ifonline}"><i class="fas fa-sign-in-alt"></i></a>
                </div>
            </div>
            <div class="card-footer pt-3">
                <div class="row">
                    <div class="col-sm-4 border-right">
                        <div class="description-block">
                            <div class="d-none" id="secretInfo">{global_IP}:{QPort}</div>
                            <h5 class="description-header">{map_str}</h5>
                            <span class="description-text">Karte</span>
                        </div>
                    </div>
                    <script>
                    // von: https://gist.github.com/anazard/d42354f45e172519c0be3cead34fe869
                    // {
                    var $body = document.getElementsByTagName('body')[0];
                    var $btnCopy = document.getElementById('btnCopy');
                    var secretInfo = document.getElementById('secretInfo').innerHTML;

                    var copyToClipboard = function(secretInfo) {
                        var $tempInput = document.createElement('INPUT');
                        $body.appendChild($tempInput);
                        $tempInput.setAttribute('value', secretInfo)
                        $tempInput.select();
                        document.execCommand('copy');
                        $body.removeChild($tempInput);
                    }

                    $btnCopy.addEventListener('click', function(ev) {
                        copyToClipboard(secretInfo);
                        alert("Kopiert: " + secretInfo);
                    });
                    // }
                    </script>
                    <div class="col-sm-4 border-right">
                        <div class="description-block">
                            <h5 class="description-header">{tmod}</h5>
                            <span class="description-text">T-MOD</span>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="description-block">
                            <h5 class="description-header"><a href="{arkservers}" target="_blank">Öffnen</a></h5>
                            <span class="description-text">ARKServers</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-footer p-0">
                <ul class="nav flex-column">
                    {ifin}<li class="nav-item p-1 text-center">
                        <a href="/cluster" class="nav-link">
                            <i class="fas fa-random pr-2" aria-hidden="true"></i> {typestr} <b>{clustername}</b>
                        </a>
                    </li>{/ifin}
                    <li class="nav-item"></li>
                    <li class="nav-item">
                        <a href="/serverpage/{cfg}/home" class="nav-link">Startseite</a>
                    </li>
                    <li class="nav-item">
                        <a href="/serverpage/{cfg}/mods" class="nav-link">Modifikationen</a>
                    </li>
                    <li class="nav-item">
                        <a href="/serverpage/{cfg}/konfig" class="nav-link">Konfiguration</a>
                    </li>
                    <li class="nav-item">
                        <a href="/serverpage/{cfg}/logs" class="nav-link">Logs</a>
                    </li>
                    <li class="nav-item">
                        <a href="/serverpage/{cfg}/backups" class="nav-link">Backups</a>
                    </li>
                    <li class="nav-item">
                        <a href="/serverpage/{cfg}/saves" class="nav-link">Savegames</a>
                    </li>
                    <li class="nav-item">
                        <a href="/serverpage/{cfg}/jobs" class="nav-link">Aufgaben</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    {panel}
</div>

<script>

    setInterval(function(){
        getphp("/sites/js/getinfos.php?cfg={cfg}&type=cards", "server-stats");
        getphp("/sites/js/getinfos.php?cfg={cfg}&type=img", "serv_img");
    }, 1000);

    $(document).ready(function() {


        $('#sendaction').click(function(e){
            e.preventDefault();


            var cfg = $("#cfg").val();
            var action = $("#action_sel").val();
            var para = new Array();
            $("input:checked").each(function() {
                para.push($(this).val());
            });

            $.ajax({
                type: "POST",
                url: "/sites/js/inzaction.php",
                dataType: "json",
                data: {cfg:cfg, action:action, para:para},
                success : function(data){
                    if (data.code == "200"){
                        $("#action_resp").html(data.msg);
                        $("#all_resp").html(data.msg);
                        $('#action').modal('hide')
                    } else {
                        $("#action_resp").html(data.msg);
                    }
                    server_data();
                }
            });


        });
    });

    $(document).ready(function() {
        $('#action_sel').change(function(e){
            var action = $("#action_sel").val();
            // uncheck_all
            ids = [{js_array}];

            for (i = 0; i < ids.length; i++) {
                $(ids[i]).prop('checked', false);
                $(ids[i]).attr('disabled', true);
            }

            {jsif}
        });
    });

</script>



<div class="modal fade" id="action" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document" style="max-width: 700px">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Befehl an den Server senden</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p id="action_resp"></p>
                <input name="cfg" id="cfg" value="{cfg}" type="hidden">
                <select name="action" id="action_sel" class="form-control">
                    {action_list}
                </select><br >

                <div class="form-row" style="padding-left: 25px">
                    {para_list}
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Schließen</button>
                <button type="submit" class="btn btn-primary" id="sendaction">Senden</button>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="danger_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document" style="max-width: 700px">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title">Fehler!</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body p-0">
                <ul class="list-group" style="border:0; border-radius: 0">
                    {danger_resp}
                </ul>
            </div>
            <div class="modal-footer bg-gray-200">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Schließen</button>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="warning_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document" id="form" style="max-width: 700px">
        <div class="modal-content">
            <div class="modal-header bg-warning text-white">
                <h5 class="modal-title" id="exampleModalLabel">Warnungen</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body p-0">
                <ul class="list-group" style="border:0; border-radius: 0">
                    {warning_resp}
                </ul>
            </div>
            <div class="modal-footer bg-gray-200">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Schließen</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="playerlist_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document" style="max-width: 700px">
        <div class="modal-content ">
            <div class="modal-header bg-orange text-white rounded-0">
                <h5 class="modal-title">Spieler (Online)</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body p-0">
                <ul class="list-group" style="border:0; border-radius: 0">{playerlist}</ul>
            </div>
            <div class="modal-footer bg-gray-200">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Schließen</button>
            </div>
        </div>
    </div>
</div>


<script type="javascript">
    getphp('/sites/js/getuser.php?cfg={cfg}', 'playerlist');
    setInterval(function(){
        getphp('/sites/js/getuser.php?cfg={cfg}', 'playerlist');
    }, 1000);


</script>
